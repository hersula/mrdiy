$(document).ready(function(){HTMLElement.prototype.startLoading=function(){var spinner=$('body>.spinner').clone().removeClass('hide');$(this).append(spinner)};HTMLElement.prototype.stopLoading=function(){$(this).find('.spinner, .spinner-backdrop').remove()};var CONFIG=window.LobiAdminConfig;window.LobiAdmin=function(element,options){this.$el=null;this.$navPanel=null;this.$settingBox=null;this.$contentPanel=null;this.$currentPage=null;var me=this;var _init=function(){me.$contentPanel=me.$el.find(CONFIG.contentSelector);me.$navPanel=_initNavigation();me.$settingBox=$(CONFIG.settingBoxSelector);$('body').data('lobiAdmin',me);if($(window).width()<=LobiAdmin.SCREEN_MD){_enableResponsiveSearchForm()}
_enableResponsiveness();_listenSpecificLinks();_readLocalStorage();_initSettingBox();_loadOnHashChange();$(window).trigger('hashchange.lobiAdmin')};var _enableResponsiveSearchForm=function(){$(CONFIG.searchFormSelector).find('.btn-search').on('click.lobiAdmin',function(ev){ev.preventDefault();ev.stopPropagation();$(this).closest('.navbar-search').addClass('navbar-search-full').find('input')[0].focus()});$(CONFIG.searchFormSelector).find('.btn-remove').on('click.lobiAdmin',function(ev){ev.preventDefault();ev.stopPropagation();me.$el.find('.navbar .navbar-search').removeClass('navbar-search-full')})};var _disableResponsiveSearchForm=function(){$(CONFIG.searchFormSelector).find('.btn-search, .btn-remove').off('click.lobiAdmin')};var _enableResponsiveness=function(){$(window).on('resize.lobiAdmin',function(){if($(window).width()<=LobiAdmin.SCREEN_MD){_disableResponsiveSearchForm();_enableResponsiveSearchForm()}else{_disableResponsiveSearchForm()}})};var _listenSpecificLinks=function(){$(document).on('click',CONFIG.fullScreenSelector,function(ev){ev.preventDefault();ev.stopPropagation();me.toggleFullScreen()});$(document).on('click',CONFIG.reloadPageSelector,function(ev){ev.preventDefault();me.reload();$(this).tooltip('hide')});$(document).on('click',CONFIG.clearLocalStorageSelector,function(ev){ev.preventDefault();if(CONFIG.confirmationBeforeClearStorage){Lobibox.confirm({"msg":CONFIG.clearStorageConfirmationMessage,callback:function(box,type,ev){if(type==='yes'){_putToLocalStorage({});window.location.reload()}}})}else{_putToLocalStorage({})}})};var _initSettingBox=function(){me.$settingBox.find('.btn-toggle').click(function(){me.$settingBox.toggleClass('opened')});var $fixHeader=me.$settingBox.find('.fix-header');var $fixMenu=me.$settingBox.find('.fix-menu');var $fixRibbon=me.$settingBox.find('.fix-ribbon');$fixHeader.change(function(){var $this=$(this);if($this.is(':checked')){me.fixHeader()}else{me.unfixHeader();$fixRibbon.prop('checked',!1);$fixMenu.prop('checked',!1)}});$fixMenu.change(function(){var $this=$(this);if($this.is(':checked')){me.fixMenu();$fixHeader.prop('checked',!0)}else{me.unfixMenu();$fixRibbon.prop('checked',!1)}});$fixRibbon.change(function(){var $this=$(this);if($this.is(':checked')){me.fixRibbon();$fixHeader.prop('checked',!0);$fixMenu.prop('checked',!0)}else{me.unfixRibbon()}});me.$settingBox.find('[name="body-bg"]').change(function(){var $this=$(this);if($this.is(':checked')){var storage=_getLocalStorage();storage.bodyBg=$this.val();_putToLocalStorage(storage);var BG;if($this.data('is-color')){BG=$this.val()}else{BG='url('+$this.val()+')'}
$('body').css('background',BG)}});me.$settingBox.find('[name="body-bg"]:checked').trigger('change');var $themes=me.$settingBox.find('[name="header-skin"]');$themes.change(function(){var $this=$(this);$themes.each(function(ind,el){$('body').removeClass(el.value)});var storage=_getLocalStorage();if($this.is(':checked')&&$this.val()!=='0'){storage.theme=$this.val();$('body').addClass($this.val())}else if($this.is(':checked')&&$this.val()==='0'){delete storage.theme}
_putToLocalStorage(storage)});me.$settingBox.find('[name="header-skin"]:checked').trigger('change')};var _initNavigation=function(){var pan=me.$el.find(CONFIG.sidebarSelector);var menu=new NavigationPanel(pan,me);pan.data('lobiAdmin.navMenu',menu);return menu};var _triggerEvent=function(eventType){var args=Array.prototype.slice.call(arguments,1);args.unshift(me);me.$el.trigger(eventType+'.lobiAdmin',args)};var _readLocalStorage=function(){if(!CONFIG.useLocalStorage){return}
var config=null,fromStorage=localStorage.getItem('lobiAdmin');try{if(fromStorage){config=JSON.parse(fromStorage)}}catch(e){window.console.error('"lobiAdmin" localStorage object is not valid JSON')}
if(config){if(config.ribbonFixed){me.$settingBox.find('.fix-ribbon').prop('checked',!0);me.$settingBox.find('.fix-menu').prop('checked',!0);me.$settingBox.find('.fix-header').prop('checked',!0);me.fixRibbon()}else if(config.menuFixed){me.$settingBox.find('.fix-menu').prop('checked',!0);me.$settingBox.find('.fix-header').prop('checked',!0);me.fixMenu()}else if(config.headerFixed){me.$settingBox.find('.fix-header').prop('checked',!0);me.fixHeader()}
if(config.bodyBg){me.$settingBox.find('[name="body-bg"][value="'+config.bodyBg+'"]').prop('checked',!0)}
if(config.theme){me.$settingBox.find('[name="header-skin"][value="'+config.theme+'"]').prop('checked',!0)}}};var _getLocalStorage=function(){var config=null,fromStorage=localStorage.getItem('lobiAdmin');try{if(fromStorage){config=JSON.parse(fromStorage)}}catch(e){window.console.error('"lobiAdmin" localStorage object is not valid JSON')}
return config||{}};var _putToLocalStorage=function(config){if($.isEmptyObject(config)){localStorage.removeItem('lobiAdmin')}else{localStorage.setItem('lobiAdmin',JSON.stringify(config))}};var _setItemToLocalStorage=function(name,value){if(!CONFIG.useLocalStorage){return}
var storage=_getLocalStorage();storage[name]=value;_putToLocalStorage(storage)};var _deleteItemFromLocalStorage=function(key){if(!CONFIG.useLocalStorage){return}
var storage=_getLocalStorage();delete storage[key];_putToLocalStorage(storage)};var _loadOnHashChange=function(){$(window).on('hashchange.lobiAdmin',function(ev){var link,hash=window.location.hash;if(hash===""){window.location.hash=CONFIG.defaultPage;return}else{link=me.$navPanel.$menu.find('a[href="'+hash+'"]')}
if(!me.$navPanel.isCollapsed()&&$(window).width()<LobiAdmin.SCREEN_MD){me.$navPanel.hide()}
me.$navPanel.setActive(hash);hash=hash.replace(/^#/,'');var hash=_rewriteUrl(hash);var innerText=link.find('.inner-text');var text=innerText.length===0?link.html():innerText.html();me.load(hash,text)})};var _rewriteUrl=function(url){if(!CONFIG.enableUrlRouting){return url}
if(LobiAdminRoutes[url]){return LobiAdminRoutes[url]}
for(var i in LobiAdminRoutes){var route=LobiAdminRoutes[i];var regExpString=i.replace(/(\_|\-)/g,'\\$1');var exp=new RegExp('^'+regExpString+"$","g");var match=exp.exec(url);if(match){var vars=[];var index=1;while(match[index]){vars.push(match[index++])}
var replaceVarIndex=1;while(route.indexOf('$'+replaceVarIndex)>-1){route=route.replace('$'+replaceVarIndex,vars[replaceVarIndex-1])
replaceVarIndex++}
return route}}
return url};this.toggleFullScreen=function(){var elem=me.$el[0];if((document.fullScreenElement!==undefined&&document.fullScreenElement===null)||(document.msFullscreenElement!==undefined&&document.msFullscreenElement===null)||(document.mozFullScreen!==undefined&&!document.mozFullScreen)||(document.webkitIsFullScreen!==undefined&&!document.webkitIsFullScreen)){elem.requestFullScreen=elem.requestFullScreen||elem.mozRequestFullScreen||elem.webkitRequestFullScreen||elem.msRequestFullscreen;elem.requestFullScreen();_triggerEvent('expandToFullScreen')}else{document.cancelFullScreen=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen;document.cancelFullScreen();_triggerEvent('collapseFromFullScreen')}
return me};this.load=function(url,title,isError){_triggerEvent('beforePageLoad',url);var contentPanel=me.$contentPanel;contentPanel.html('')[0].startLoading();$.ajax({type:'GET',dataType:'html',beforeSend:function(xhr){xhr.setRequestHeader('x-menu-id',CurrMenuID)},url:url,success:function(html){contentPanel.html(html)[0].stopLoading();me.$currentPage=url;me.drawBreadcrumbs();if(title){$('title').html(title)}
_triggerEvent('pageLoaded',url)},error:function(xhr,status,code){if(!isError){if(xhr.status===404){me.load(CONFIG.error404Page,CONFIG.error404Title,!0)}else if(xhr.status===500){me.load(CONFIG.error500,CONFIG.error500Title,!0)}}else{contentPanel.html('')[0].stopLoading()}}});return me};this.reload=function(){me.load(me.$currentPage);_triggerEvent('reload');return me};this.drawBreadcrumbs=function(){var path=me.$navPanel.getActivePath();var $br=$(CONFIG.breadcrumbsListSelector);$br.html("");for(var i=0;i<path.length;i++){var $li;if(i===0){var $li=$('<li>'+path[i].text+'</li>');$li.addClass('active');if(path[i].icon){$li.prepend(path[i].icon," ")}}else{var $li=$('<li><a href="'+path[i].href+'">'+path[i].text+'</a></li>');if(path[i].icon){$li.find('>a').prepend(path[i].icon," ")}}
$br.prepend($li)}
return me};this.fixHeader=function(){$('body').addClass('header-fixed');_setItemToLocalStorage('headerFixed',!0);return me};this.unfixHeader=function(){$('body').removeClass('header-fixed');$('body').removeClass('menu-fixed');$('body').removeClass('ribbon-fixed');_deleteItemFromLocalStorage('headerFixed');_deleteItemFromLocalStorage('menuFixed');_deleteItemFromLocalStorage('ribbonFixed');return me};this.fixMenu=function(){$('body').addClass('menu-fixed');$('body').addClass('header-fixed');_setItemToLocalStorage('menuFixed',!0);_setItemToLocalStorage('headerFixed',!0);return me};this.unfixMenu=function(){$('body').removeClass('menu-fixed');$('body').removeClass('ribbon-fixed');_deleteItemFromLocalStorage('menuFixed');_deleteItemFromLocalStorage('ribbonFixed');return me};this.fixRibbon=function(){$('body').addClass('ribbon-fixed');$('body').addClass('header-fixed');$('body').addClass('menu-fixed');_setItemToLocalStorage('ribbonFixed',!0);_setItemToLocalStorage('menuFixed',!0);_setItemToLocalStorage('headerFixed',!0);return me};this.unfixRibbon=function(){$('body').removeClass('ribbon-fixed');_deleteItemFromLocalStorage('ribbonFixed');return me};this.$el=element;_init()};var LOADED_SCRIPTS=[];var LOADED_CSS=[];LobiAdmin.loadScript=function(srcs,callback){if(typeof srcs==='string'){srcs=[srcs]}
var body=document.getElementsByTagName('body')[0];var size=srcs.length;var countLoaded=0;var allIsAlreadyLoaded=!0;var SCRIPTS=[];var IND=0;for(var i=0;i<size;i++){if(LOADED_SCRIPTS.indexOf(srcs[i])>-1){countLoaded++;continue}
allIsAlreadyLoaded=!1;SCRIPTS[IND]=document.createElement('script');SCRIPTS[IND].type='text/javascript';SCRIPTS[IND].src=srcs[i];SCRIPTS[IND].onload=function(e){LOADED_SCRIPTS.push(e.target.getAttribute('src').toString());countLoaded++;if(countLoaded===size&&callback&&typeof callback==='function'){callback()}};body.appendChild(SCRIPTS[IND]);IND++}
if(allIsAlreadyLoaded&&callback&&typeof callback==='function'){callback()}};LobiAdmin.loadCSS=function(href,callback){if(typeof href==='string'){href=[href]}
var head=document.getElementsByTagName('head')[0];var size=href.length;var countLoaded=0;var allIsAlreadyLoaded=!0;var SOURCES=[];var IND=0;for(var i=0;i<size;i++){if(LOADED_CSS.indexOf(href[i])>-1){countLoaded++;continue}
allIsAlreadyLoaded=!1;SOURCES[IND]=document.createElement('link');SOURCES[IND].rel='stylesheet';SOURCES[IND].href=href[i];SOURCES[IND].onload=function(e){LOADED_CSS.push(e.path[0].getAttribute('href').toString());countLoaded++;if(countLoaded===size&&callback&&typeof callback==='function'){callback()}};head.appendChild(SOURCES[IND]);IND++}
if(allIsAlreadyLoaded&&callback&&typeof callback==='function'){callback()}};LobiAdmin.highlightCode=function(){var $codes=$('.highlight code');$codes.each(function(index,el){hljs.highlightBlock(el)})};LobiAdmin.lightenColor=function(col,amt){var usePound=!1;if(col[0]==="#"){col=col.slice(1);usePound=!0}
var num=parseInt(col,16);var r=(num>>16)+amt;if(r>255)
r=255;else if(r<0)
r=0;var b=((num>>8)&0x00FF)+amt;if(b>255)
b=255;else if(b<0)
b=0;var g=(num&0x0000FF)+amt;if(g>255)
g=255;else if(g<0)
g=0;return(usePound?"#":"")+(g|(b<<8)|(r<<16)).toString(16)};LobiAdmin.fadeOutColor=function(col,amt){if(col[0]==="#"){col=col.slice(1)}
if(!isNaN(parseInt(col,16))){var r=parseInt(col.substring(0,2),16);var g=parseInt(col.substring(2,4),16);var b=parseInt(col.substring(4),16);return'rgba('+r+', '+g+', '+b+', '+(1-amt/100).toFixed(2)+')'}
else if(col.substr(0,4).toLowerCase()==='rgba'){amt=Math.max(parseFloat(col.match(/rgba\(\d+\,\s?\d+\,\s?\d+\,\s?(\d(\.\d+)?)/)[1],10)-(amt/100),0).toFixed(2);return col.replace(/(rgba\(\d+\,\s?\d+\,\s?\d+\,\s?)(\d(\.\d+)?)/gi,'$1'+amt)}
else if(col.substr(0,3).toLowerCase()==='rgb'){return col.replace(/(rgb)(\(\d+\,\s?\d+\,\s?\d+)/gi,'$1a$2, '+(1-amt/100).toFixed(2))}};var NavigationPanel=function(panel,lobiAdmin){this.$el=panel;this.$menu=null;this.$showHideBtn=null;this.$lobiAdmin=lobiAdmin;var me=this;var _init=function(){me.$menu=me.$el.find('nav');me.$showHideBtn=$(CONFIG.sidebarHideShowSelector);me.$menu.find('ul>li>a').off('click.lobiAdmin').on('click.lobiAdmin',function(e){if(me.isCollapsed()&&$(this).next('ul').length>0&&me.isParentLink($(this))){e.preventDefault();return!1}
me.toggleItem($(this))});_enableToggle();_enableHideShow();_preventEmptyLinksClick();_addToggleIconsToMenu();_showMenuToggleIcon();_enableMenuHeaderButtonTooltips();me.$menu.find('ul>li>a').click(function(ev){var a=$(this);if(a.attr('href')==='#'){return}else if(window.location.hash===a.attr('href')){ev.preventDefault()}})};var _enableMenuHeaderButtonTooltips=function(){var $btns=me.$el.find('.menu-header-buttons .btn').tooltip({container:'body'});if($(window).width()<LobiAdmin.SCREEN_MD){$btns.on('click',function(){$(this).tooltip('hide')})}};var _preventEmptyLinksClick=function(){me.$menu.find('a[href="#"]').on('click.lobiAdmin',function(ev){ev.preventDefault()})};var _hideMenuOnOutsideClick=function(){$(document).off('mouseup.lobiAdmin').on('mouseup.lobiAdmin',function(e){if(!me.$el.is(e.target)&&me.$el.has(e.target).length===0&&!me.$showHideBtn.is(e.target)&&me.$showHideBtn.has(e.target).length===0){me.hide()}})};var _addToggleIconsToMenu=function(){var $links=me.$menu.find('ul>li>a');$links.each(function(ind,a){var $a=$(a);if($a.next('ul').length>0&&$a.find('.menu-item-toggle-icon').length===0){if($a.closest('ul').parent().closest('ul').length===0){$a.append($('<i class="'+CONFIG.menuItemIcon+' menu-item-toggle-icon"></i>'))}else{$a.append($('<i class="'+CONFIG.submenuItemIcon+' menu-item-toggle-icon"></i>'))}}})};var _enableHideShow=function(){me.$showHideBtn.on('click.lobiAdmin',function(ev){ev.preventDefault();me.hideShow()})};var _showMenuToggleIcon=function(){var $btn=$(CONFIG.sidebarCollapseExpandSelector);$btn.append('<i class="'+CONFIG.menuToggleIcon+'"></i>')};var _enableToggle=function(){$(document).on('click.lobiAdmin',CONFIG.sidebarCollapseExpandSelector,function(){me.toggle()})};var _triggerEvent=function(eventType){var args=Array.prototype.slice.call(arguments,1);args.unshift(me.$lobiAdmin);me.$lobiAdmin.$el.trigger(eventType+'.lobiAdmin',args)};this.toggleItem=function(a){var li=a.parent();if(li.hasClass('opened')){me.collapseItem(a)}else{me.expandItem(a)}
return me};this.expandItem=function(a){if(a.next('ul').length>0){me.collapseItem(a.closest('ul').find('>li.opened>a'));if(me.isCollapsed()&&me.isParentLink(a)){a.next('ul').css('display','block')}else{a.next('ul').slideDown(CONFIG.panelItemToggleAnimationDuration)}
a.parent().addClass('opened');var icon=a.find('.menu-item-toggle-icon');if(me.isParentLink(a)){icon.removeClass(CONFIG.menuItemIcon).addClass(CONFIG.menuItemExpandIcon)}else{icon.removeClass(CONFIG.submenuItemIcon).addClass(CONFIG.submenuItemExpandedIcon)}
_triggerEvent('menuItemExpand')}
return me};this.collapseItem=function(a){if(a.next('ul').length>0){a.parent().removeClass('opened');if(me.isCollapsed()&&me.isParentLink(a)){a.next('ul').css('display','none')}else{a.next('ul').slideUp(CONFIG.panelItemToggleAnimationDuration)}
var icon=a.find('.menu-item-toggle-icon');if(me.isParentLink(a)){icon.removeClass(CONFIG.menuItemExpandIcon).addClass(CONFIG.menuItemIcon)}else{icon.removeClass(CONFIG.submenuItemExpandedIcon).addClass(CONFIG.submenuItemIcon)}
_triggerEvent('menuItemCollapse')}
return me};this.collapse=function(){if(me.isCollapsed()){return me}
var $btn=$(CONFIG.sidebarCollapseExpandSelector);$btn.find('>*').removeClass(CONFIG.menuToggleIcon).addClass(CONFIG.menuToggleCollapsedIcon);$('body').addClass('menu-collapsed');_triggerEvent('menuCollapse');return me};this.expand=function(){if(!me.isCollapsed()){return me}
var $btn=$(CONFIG.sidebarCollapseExpandSelector);$btn.find('>*').removeClass(CONFIG.menuToggleCollapsedIcon).addClass(CONFIG.menuToggleIcon);$('body').removeClass('menu-collapsed');_triggerEvent('menuExpand');return me};this.toggle=function(){if(me.isCollapsed()){me.expand()}else{me.collapse()}
return me};this.isCollapsed=function(){if($('body').hasClass('menu-collapsed')){return!0}else{return!1}};this.isParentLink=function(href){var a=href;if(typeof href==='string'){a=me.$menu.find('>ul>li>a[href="'+href+'"]')}
if(a.length!==1){return!1}
if(a.closest('ul').parent().closest('ul').length>0){return!1}
return!0};this.getParentLink=function(a){var li=a.closest('ul').closest('li');if(li.length===0){return!1}
return li.find('>a')};this.setActive=function(href){var a=me.$menu.find('a[href="'+href+'"]');if(a.length===0||a.parent().hasClass('active')){return}
var act=me.$menu.find('li.active');act.removeClass('active');a.parent().addClass('active');var parent=me.getParentLink(a);while(parent){if(parent.parent().hasClass('opened')){parent=me.getParentLink(parent);continue}
me.expandItem(parent);parent=me.getParentLink(parent)}};this.getActive=function(){var act=me.$menu.find('li.active >a');return act.length===0?null:act};this.hide=function(){if($(window).width()<LobiAdmin.SCREEN_MD){$('body').removeClass('menu-hidden');me.$showHideBtn.removeClass('active')}else{$('body').addClass('menu-hidden');me.$showHideBtn.addClass('active')}
_triggerEvent('menuHide');return me};this.show=function(){if($(window).width()<LobiAdmin.SCREEN_MD){$('body').addClass('menu-hidden');me.$showHideBtn.addClass('active');_hideMenuOnOutsideClick()}else{$('body').removeClass('menu-hidden');me.$showHideBtn.removeClass('active')}
_triggerEvent('menuShow');return me};this.isHidden=function(){if($('body').hasClass('menu-hidden')&&$(window).width()>=LobiAdmin.SCREEN_MD||!$('body').hasClass('menu-hidden')&&$(window).width()<LobiAdmin.SCREEN_MD){return!0}
return!1};this.hideShow=function(){me.isHidden()?me.show():me.hide();return me};this.getActivePath=function(){var me=this;var ret=[];var act=me.getActive();while(act){var icon=act.find('.menu-item-icon').clone();ret.push({icon:icon.length>0?icon:null,text:act.find('.inner-text').html()||act.html(),href:act.attr('href')});var act=me.getParentLink(act)}
return ret};_init()};LobiAdmin.SCREEN_XS=480;LobiAdmin.SCREEN_SM=768;LobiAdmin.SCREEN_MD=992;LobiAdmin.SCREEN_LG=1200;$.fn.lobiAdmin=function(option){return this.each(function(index,el){var $this=$(this);var data=$this.data('lobiAdmin');var options=typeof option==='object'&&option;if(!data){$this.data('lobiAdmin',(data=new window.LobiAdmin($this,options)))}
if(typeof option==='string'){data[option]()}})};$('body').lobiAdmin()})